package com.java.servlets;
import java.io.IOException;



import java.net.MalformedURLException;
import java.util.ArrayList;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.google.gdata.util.AuthenticationException;


import com.google.gdata.util.ServiceException;

//import com.google.gdata.util.AuthenticationException;
import Applic.Youtube;

public class Connexion  extends HttpServlet{
	public Youtube youtube;
	public ArrayList<String> playlists = new ArrayList<String>();
 public void doGet( HttpServletRequest request,
HttpServletResponse response ) throws ServletException, IOException
{
 String login = request.getParameter( "loginClient" );
 String password = request.getParameter( "passClient" );
 String message = "";
 System.out.println(login);

	try {
		youtube = new Youtube(login,password);
		//message = "authentification effectuée avec succès";
		addPlaylist();
		request.setAttribute( "message", list );
		this.getServletContext().getRequestDispatcher("/WEB-INF/Connexion.jsp" ).forward( request, response );
	} catch (AuthenticationException e) {
		message = "Erreur d'authentification!";
		request.setAttribute( "message", message );
		this.getServletContext().getRequestDispatcher("/WEB-INF/Test.jsp" ).forward( request, response );
		e.printStackTrace();
		}
	}
 	public String addPlaylist() {
	{
 		try {
 			String list = null;
			playlists = youtube.getUserPlaylists();
			for(int i=0;i<playlists.size();i++)
			{
				list = list + "\n" + playlists.get(i);
			}
			return list;
		} catch (IOException | ServiceException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			return null;
		}
 		
 	}
}
}
